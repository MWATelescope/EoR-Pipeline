params {
    hyperdrive = 'hyperdrive'
    birli = 'birli'
    giant_squid = 'giant-squid'
    jq = 'jq'
    obsids_path = 'obsids.csv'
    cal_params_path = 'cal_params.csv'
    asvo_api_key = 'EMPTY'
    cal_suffix = ''
    // imaging
    img_suffix = ''
    img_size = 4096
    img_scale = '40asec'
    img_niter = 1000
    img_auto_threshold = 1
    img_auto_mask = 5
    img_mem = 100
    img_channels_out = '24'
}
profiles {
    dug {
        singularity {
            cacheDir = '/data/curtin_mwaeor/singularity'
        }
        executor {
            $slurm {
                queueSize = 20
                submitRateLimit = '1s'
            }
        }
        process {
            scratch = true
            executor = 'slurm'
            queue = 'curtin_mwaeor'
            cpus = 2
            memory = '100G'
            withLabel: cpu {
                cpus = 24
            }
            withLabel: gpu {
                cpus = 32
                // clusterOptions = '--constraint=a100x4'
                clusterOptions = '--constraint=v100x4'
            }
            withLabel: img {
                memory = "${params.img_mem}G"
                clusterOptions = '--constraint=clx'
            }
        }
        params {
            outdir = '/data/curtin_mwaeor/data'
            hyperdrive = '/data/curtin_mwaeor/sw/bin/hyperdrive'
            birli = 'singularity exec --bind $PWD:/tmp --writable-tmpfs --pwd /tmp --no-home /data/curtin_mwaeor/sw/singularity/birli/birli_latest.sif /opt/cargo/bin/birli'
            mwa_qa_sif = '/data/curtin_mwaeor/sw/singularity/mwa_qa/mwa_qa_latest.sif'
            giant_squid = '/data/curtin_mwaeor/sw/bin/giant-squid'
            jq = '/data/curtin_mwaeor/sw/bin/jq'
            wsclean = '/data/curtin_mwaeor/sw/bin/wsclean'
            sourcelist = '/data/curtin_mwaeor/data/srclist_pumav3_EoR0LoBESv2_fixedEoR1pietro+ForA_phase1+2.yaml'
            beam_path = '/data/curtin_mwaeor/data/mwa_full_embedded_element_pattern.h5'
            // todo: can't determine this from nvidia-smi
            // cuda_compute = 80 // a100
            cuda_compute = 70 // v100
            num_gpus = 4
        }
    }
    sirius {
        process {
            scratch = '/tmp/mwaeor'
            executor = 'local'
        }
        params {
            outdir = '/data/dev'
            hyperdrive = '/usr/local/bin/hyperdrive'
            sourcelist = '/data/dev/calibration/srclist_pumav3_EoR0LoBESv2_fixedEoR1pietro+ForA_phase1+2.txt'
            beam_path = '/data/dev/calibration/mwa_full_embedded_element_pattern.h5'
            cuda_compute = 75
        }
    }
}